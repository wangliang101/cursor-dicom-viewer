# DICOM 影像阅片工具栏

## 概述

本项目为DICOM影像阅片器实现了一个功能完整的工具栏，参考了cornerstonejs和OHIF等知名影像阅片软件的设计，提供了专业的医学影像处理功能。

## 功能特性

### 🔧 基础工具组

- **窗宽窗位** - 调整图像对比度和亮度
- **平移** - 移动图像位置
- **缩放** - 放大缩小图像
- **十字线** - 精确定位和测量

### 🔍 缩放控制组

- **放大** - 按1.2倍放大图像
- **缩小** - 按1/1.2倍缩小图像
- **适应窗口** - 自动调整图像大小适应视窗
- **缩放显示** - 实时显示当前缩放百分比

### 🔄 图像变换组

- **重置** - 恢复图像到初始状态
- **旋转** - 逆时针/顺时针旋转90度
- **翻转** - 水平/垂直翻转图像
- **反色** - 黑白反转，便于观察不同细节

### 📏 测量工具组

- **长度测量** - 测量两点间距离
- **角度测量** - 测量角度
- **矩形ROI** - 矩形感兴趣区域分析
- **圆形ROI** - 圆形感兴趣区域分析
- **双向测量** - 双向长度测量
- **像素探针** - 查看像素值

### ▶️ 序列播放控制组

- **播放/暂停** - 自动播放图像序列
- **上一帧/下一帧** - 手动切换图像
- **帧信息显示** - 显示当前帧数和总帧数

### ⚙️ 高级功能

- **窗宽窗位设置** - 提供预设窗口和自定义调节
  - 肺窗 (W:1500, C:-600)
  - 腹部窗 (W:400, C:50)
  - 脑窗 (W:80, C:40)
  - 骨窗 (W:2000, C:300)
  - 纵隔窗 (W:350, C:50)
  - 肝脏窗 (W:150, C:30)
  - 自定义窗口
- **图像信息** - 显示DICOM标签
- **设置** - 工具配置选项

## 技术实现

### 核心技术栈

- **React** - 组件化开发
- **Ant Design** - UI组件库
- **Cornerstone.js** - 医学影像渲染引擎
- **Cornerstone Tools** - 影像工具集

### 文件结构

```
src/
├── components/
│   └── toolbar/
│       ├── DicomToolbar.jsx          # 主工具栏组件
│       └── DicomToolbar.module.less  # 工具栏样式
├── utils/
│   └── imageTransforms.js            # 图像变换工具函数
└── pages/
    └── Viewer/
        ├── index.jsx                 # 更新的查看器页面
        └── index.module.less         # 更新的样式文件
```

### 主要组件

#### DicomToolbar 组件

- 模块化设计，每个功能组独立
- 响应式布局，适配不同屏幕尺寸
- 工具提示和状态反馈
- 预设窗宽窗位快速切换

#### imageTransforms 工具函数

- 图像重置、旋转、翻转、反色
- 缩放和平移控制
- 窗宽窗位设置
- 错误处理和日志记录

## 使用方法

### 基本操作

1. **上传DICOM文件** - 点击"上传DICOM文件"按钮
2. **选择工具** - 点击工具栏中的相应工具图标
3. **调整图像** - 使用缩放、平移、旋转等功能
4. **测量分析** - 选择测量工具进行长度、角度测量

### 窗宽窗位调整

1. 点击窗宽窗位设置按钮（齿轮图标）
2. 选择预设窗口或手动调整数值
3. 使用滑块实时预览效果

### 序列播放

1. 上传多帧DICOM文件
2. 使用播放控制按钮
3. 调整帧率滑块控制播放速度

## 响应式设计

工具栏采用响应式设计，在不同设备上提供最佳用户体验：

- **桌面端** (>1200px) - 完整工具栏显示
- **平板端** (768px-1200px) - 紧凑布局
- **移动端** (<768px) - 垂直堆叠，隐藏分割线

## 样式特性

- **现代化设计** - 渐变色、阴影效果、圆角
- **流畅动画** - 悬停效果、状态转换
- **一致性** - 统一的颜色主题和字体规范
- **可访问性** - 合适的对比度和字体大小

## 扩展性

工具栏设计具有良好的扩展性：

1. **新增工具** - 在DicomToolbar组件中添加新工具按钮
2. **自定义功能** - 通过props传递回调函数
3. **样式定制** - 修改LESS变量自定义主题
4. **国际化** - 支持多语言文本替换

## 兼容性

- 支持现代浏览器 (Chrome, Firefox, Safari, Edge)
- 兼容移动设备触摸操作
- 支持键盘快捷键（计划中）

## 性能优化

- 组件懒加载
- 工具状态缓存
- 防抖处理用户输入
- 内存管理和清理

## 未来规划

- [ ] 键盘快捷键支持
- [ ] 更多预设窗宽窗位
- [ ] 标注和绘图工具
- [ ] 3D重建功能
- [ ] 多平面重建 (MPR)
- [ ] 图像配准和融合
- [ ] AI辅助诊断集成

## 贡献指南

欢迎贡献代码和建议：

1. Fork 项目
2. 创建功能分支
3. 提交更改
4. 发起 Pull Request

## 许可证

本项目采用 MIT 许可证。
